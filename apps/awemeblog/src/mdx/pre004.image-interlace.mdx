---
title: "åšå®¢å›¾ç‰‡æ¸è¿›å¼åŠ è½½ä¼˜åŒ–"
author: "hanhan.rich"
description: "åšå®¢å›¾ç‰‡æ¸è¿›å¼åŠ è½½ä¼˜åŒ–"
pubDate: "2023.11.16"
---
## èƒŒæ™¯

å¾ˆå¤šäººæœ‰å†™åšå®¢çš„ä¹ æƒ¯ï¼Œä¼šä½¿ç”¨å¾ˆå¤šå›¾ç‰‡æ¥è¿›è¡Œè¡¨è¾¾ï¼Œä¼˜åŒ–è¯»è€…ä½“éªŒã€‚ä½†åœ¨ç½‘é€Ÿæ…¢çš„æƒ…å†µä¸‹ï¼Œä¸€å¼ å¤§å›¾ä»ä¸Šåˆ°ä¸‹æ…¢æ…¢åŠ è½½å‡ºæ¥ï¼Œéš¾å…ä¼šä½¿ç”¨æˆ·ç„¦è™‘ã€‚è¿™é‡Œæå‡ºé’ˆå¯¹ jpgã€png ç­‰åšå®¢å¸¸è§çš„å›¾ç‰‡è¿›è¡Œäº¤é”™ï¼ˆinterlaceï¼‰ä¼˜åŒ–ï¼Œä»¥ç‰ºç‰²å›¾ç‰‡ä½“ç§¯ä¸ºå‰æï¼Œè®©ç”¨æˆ·å°½å¿«çœ‹åˆ°å›¾ç‰‡ã€‚

## é—®é¢˜åˆ†æ

é’ˆå¯¹å›¾ç‰‡åŠ è½½æ…¢ï¼ŒåŠ è½½é—ªåŠ¨ï¼Œå…¶å®å¯ä»¥åˆ†ç±»ä¸ºä¸¤ä¸ªé—®é¢˜ã€‚

- å›¾ç‰‡æ— å ä½ï¼ŒåŠ è½½é—ªåŠ¨
    - ä»¥åšå®¢å›¾ç‰‡ä¸¾ä¾‹ï¼ˆrspressã€hexo ç­‰ï¼‰ï¼Œå¯ä»¥ç¼–å†™æ’ä»¶ï¼Œåœ¨æ‰“åŒ…æ—¶è·å–å›¾ç‰‡å®½é«˜ï¼Œè¿›è¡Œå®½é«˜ä¸Šçš„å ä½ã€‚
    - äºŒæ˜¯æ‰“åŒ…æ—¶ï¼Œå¯ä»¥å€ŸåŠ©ä¸€äº›å·¥å…·ï¼Œç”Ÿæˆå›¾ç‰‡çš„ base64 ç¼©ç•¥å›¾ï¼Œå†…è”åœ¨ html æ¨¡æ¿ä¸­ï¼Œåœ¨åŠ è½½åè¿›è¡Œæ›¿æ¢ã€‚
- å›¾ç‰‡ä»ä¸Šåˆ°ä¸‹åŠ è½½æ…¢ï¼Œé—ªåŠ¨ + ç­‰å¾…æ—¶é—´é•¿
    - å›¾ç‰‡ä»ä¸Šåˆ°ä¸‹ã€ä»å·¦å‘å³åŠ è½½ï¼Œå¯ä»¥å€ŸåŠ©å›¾ç‰‡äº¤é”™ç¼–ç è§£å†³ã€‚

## é—®é¢˜è§£å†³

### å›¾ç‰‡é—ªåŠ¨æœªå ä½

#### TODOå¾…è¡¥å……

### å›¾ç‰‡ä»ä¸Šåˆ°ä¸‹åŠ è½½æ…¢

> äº¤é”™ã€interlaceã€‘

é’ˆå¯¹å›¾ç‰‡ä»ä¸Šåˆ°ä¸‹åŠ è½½æ…¢ï¼Œå·²ç»æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œé‚£å°±æ˜¯å°†å›¾ç‰‡äº¤é”™ç¼–ç ã€‚jpg å’Œ png éƒ½å¾ˆå¥½çš„æ”¯æŒäº†äº¤é”™ç¼–ç ã€‚

#### ä»€ä¹ˆæ˜¯äº¤é”™

æœªäº¤é”™å›¾ç‰‡ç¼–ç é¡ºåºå°±æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œå› æ­¤ç½‘ç»œè·å–çš„é¡ºåºä¹Ÿæ˜¯ä»ä¸Šåˆ°ä¸‹çš„ã€‚ç”¨æˆ·ä½“æ„Ÿä¸Šå°±æ˜¯å›¾ç‰‡ä»ä¸Šåˆ°ä¸‹åŠ è½½äº†ã€‚

è€Œäº¤é”™åˆ™æ˜¯å°†å›¾ç‰‡åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºï¼Œç„¶åç½‘ç»œè·å–æ—¶ä¼šåœ¨æ¯ä¸ªåŒºéƒ½è·å–ä¸€éƒ¨åˆ†å›¾ç‰‡ã€‚ç”¨æˆ·ä½“æ„Ÿä¸Šå°±æ˜¯å›¾ç‰‡å¾ˆå¿«åŠ è½½å¥½ï¼Œå¹¶ä¸€å¼€å§‹æ˜¯æ¨¡ç³Š/åƒç´ çš„ï¼Œåé¢é€æ¸æ¸…æ™°ã€‚

- äº¤é”™ä¼˜ç‚¹

    - åŠ è½½å¿«ï¼Œç”¨æˆ·ä½“éªŒå¥½

- äº¤é”™ç¼ºç‚¹
    - å›¾ç‰‡ä½“ç§¯å˜å¤§
    - äº¤é”™å¤„ç†éº»çƒ¦

æˆ‘ä»¥ä¸¤å¼  gif åŠ¨å›¾è§£é‡Šä»€ä¹ˆæ˜¯äº¤é”™ã€‚

![3](../assets/pre/public/image-interlace/3.gif)

![4](../assets/pre/public/image-interlace/4.gif)

é’ˆå¯¹å›¾ç‰‡å¤„ç†ï¼Œä¼˜åŒ–ä¸ºäº¤é”™æœ‰å“ªäº›æ–¹æ³•å‘¢ï¼Ÿæˆ‘å½’ä¸ºä¸¤ç±»ï¼š

- é€šè¿‡photoshopå¤„ç†å›¾ç‰‡
- é€šè¿‡imagemagickå¤„ç†å›¾ç‰‡

#### æ–¹æ¡ˆ 1 äººå·¥ photoshop ç”Ÿæˆ

å¦‚æœæ˜¯ UI å‡ºå›¾ï¼Œç”¨ photoshop æ²¡æœ‰ä»€ä¹ˆä¸æ–¹ä¾¿çš„ã€‚ä½†ä»¥æˆ‘è‡ªå·±å†™åšå®¢ä¸ºä¾‹ï¼Œå¤šæ˜¯ç”»ä¸€å¼ å›¾ï¼Œæˆ–æˆªä¸€å¼ å›¾ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœéƒ½ç”¨ photoshop æ‰‹åŠ¨å¤„ç†å°±æ€ªéº»çƒ¦äº†~

![1](../assets/pre/public/image-interlace/1.png)

![2](../assets/pre/public/image-interlace/2.png)

#### æ–¹æ¡ˆ 2 å€ŸåŠ© imagemagick ç”Ÿæˆ

![5](../assets/pre/public/image-interlace/5.png)

imagemagick æ˜¯ä¸€ä¸ªå¾ˆç‰›çš„å›¾ç‰‡å¤„ç†ç¨‹åºï¼Œå¯åœ¨ windowsã€macosã€linux ä¸Šå®‰è£…ä½¿ç”¨ã€‚å¾ˆå¤šå›¾ç‰‡å¤„ç†è½¯ä»¶ä¹Ÿä½¿ç”¨äº†å®ƒã€‚å¯ä»¥è¯´ä»–åœ¨å›¾ç‰‡å¤„ç†çš„åœ°ä½å’Œ ffmpegï¼ˆä¸€ä¸ªè§†é¢‘å¤„ç†è½¯ä»¶ï¼‰ç›¸å½“ã€‚

å®ƒä½œä¸ºå›¾ç‰‡å¤„ç†çš„ç‘å£«å†›åˆ€ï¼Œæä¾›äº†å¤§é‡æœ‰ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ä¾‹å¦‚ convertï¼ˆå›¾ç‰‡è½¬æ¢å·¥å…·ï¼‰ã€identifyï¼ˆå›¾ç‰‡ä¿¡æ¯è·å–å·¥å…·ï¼‰ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šä½¿ç”¨è¿™ identify æ¥è¯†åˆ«å›¾åƒæ˜¯å¦æ˜¯äº¤é”™çš„ï¼Œå¹¶ä½¿ç”¨ convert æ¥å°†æ²¡æœ‰äº¤é”™çš„å›¾ç‰‡äº¤é”™ã€‚

ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª shell script å¯¹ä¸€ä¸ªç›®å½•ä¸‹çš„å›¾ç‰‡è¿›è¡Œå¤„ç†ï¼Œè‹¥æœªäº¤é”™ï¼Œåˆ™æ”¹ä¸ºäº¤é”™ï¼›è‹¥å·²ç»ä¸ºäº¤é”™ï¼Œåˆ™ä¸å¤„ç†ã€‚

- ä½¿ç”¨`convert -interlace plane -quality 80 $filename $newfilename`æ¥å°†å›¾ç‰‡ä¼˜åŒ–ä¸ºäº¤é”™çš„å›¾ç‰‡ã€‚

    - å…¶ä¸­è¿™æ¡å‘½ä»¤è¿˜å°†å›¾ç‰‡çš„è´¨é‡è®¾ç½®ä¸º 80ï¼Œä»¥é¿å…äº¤é”™åä½“ç§¯ä¼šå¤§é‡å¢é•¿ï¼ˆæ²¡é”™ä½“ç§¯ä¼šå¢é•¿ï¼Œä½†åŠ è½½é¡ºåºç”±ç²¾è‡´çš„å±€éƒ¨å˜æˆäº†ç²—ç•¥çš„å…¨å±€ï¼‰ã€‚

- ä½¿ç”¨`identify -quiet -format "%[interlace]" $filename`æ¥è·å–å›¾ç‰‡æ˜¯å¦ä¸ºäº¤é”™çš„ã€‚

- ä½¿ç”¨`find ../docs/public/ -iname "*.png" -o -iname "*.jpg" -o -iname "*.jpeg"`æ¥æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸‹ï¼Œä»¥ pngã€jpe?g ç»“å°¾çš„å›¾ç‰‡ã€‚

è¯ä¸å¤šè¯´ï¼Œä¸Šé“¾æ¥ã€‚

https://github.com/hanhan9449/hanhan9449.github.io/blob/master/scripts/image-interlace.sh

```bash
# æˆ‘æ˜¯å¤„ç†çš„è„šæœ¬
title="å°† jpgã€png ç­‰æ ¼å¼çš„å›¾ç‰‡ä¼˜åŒ–ä¸ºäº¤é”™åçš„å›¾ç‰‡"
echo "$title start"
count=0
for i in $(find ../docs/public/ -iname '*.png' -o -iname '*.jpg' -o -iname '*.jpeg') ; do
interlace=$(identify -quiet -format "%[interlace]" $i)
if [[ "$interlace" == "PNG" ]] || [[ "$interlace" == "JPEG" ]]; then
  echo "$i å·²äº¤é”™ï¼Œcontinue..."
    continue
fi
convert -interlace plane -quality 80 "$i" "$i";
count=$((count + 1))
echo "$i äº¤é”™å®Œæˆâœ…"
done
echo "ğŸŒˆğŸŒˆæœ¬æ¬¡å…±æ–°å¢ $count ä¸ªå›¾ç‰‡"
echo "$title end"

```

#### ã€è¿›é˜¶ã€‘å€ŸåŠ© github action è‡ªåŠ¨åŒ–

æ¯æ¬¡å†™éƒ½å¾ˆç´¯äº†ï¼Œä½•å†µæˆ‘åˆä¸æ˜¯æ¯æ¬¡éƒ½åœ¨ä¸€å°æœ‰ imagemagick çš„ç”µè„‘ä¸Šå†™ï¼Œèƒ½ä¸èƒ½æœ‰ä¸ªæœºå™¨äººç®€åŒ–æˆ‘çš„æ“ä½œï¼Œå¸®æˆ‘è‡ªåŠ¨è¿è¡Œä¸Šé¢çš„è„šæœ¬ã€‚

å¯ä»¥å€ŸåŠ© github actionï¼Œå¸®åŠ©ç®€åŒ–åšè¿™ä»¶äº‹ã€‚åªéœ€è¦åœ¨è§¦å‘æŸä¸ªæ¡ä»¶çš„æ—¶å€™ï¼ˆä¾‹å¦‚ä¿®æ”¹ masterã€æˆ–æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡ï¼‰ï¼Œè‡ªåŠ¨æ‰§è¡Œä¼˜åŒ–ï¼Œå¹¶æ PRã€‚è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šé“¾æ¥ã€‚

https://github.com/hanhan9449/hanhan9449.github.io/blob/master/.github/workflows/make-image-interlace.yml

ä¸‹é¢çš„ action ä¸»è¦åšäº†ä¸‰ä»¶äº‹

- checkoutï¼Œå°†ä»“åº“ clone ä¸‹æ¥
    - å› ä¸ºæˆ‘ä»¬è¦ä¿®æ”¹è¿™ä¸ªä»“åº“ï¼Œå¹¶ä»¥æ PR çš„æ–¹å¼ä¿®æ”¹ã€‚
- æ‰§è¡Œè„šæœ¬

    - é’ˆå¯¹è¯¥ä»“åº“çš„å›¾ç‰‡ï¼Œè¿›è¡Œä¼˜åŒ–ã€ä¿®æ”¹ã€‚

- ä»¥ä¿®æ”¹ç»“æœåˆ›å»º PR
    - å°†ä¸Šé¢çš„ä¼˜åŒ–æ±‡æ€»ï¼Œå¹¶åˆ›å»º PRã€‚
    - ç”¨æˆ·åˆå¹¶å¯¹åº”çš„ PR åˆ™èƒ½å®Œæˆå›¾ç‰‡äº¤é”™çš„ä¿®æ”¹ã€‚

```yaml
name: Make image interlace
on:
  push:
    branches:
      - master

jobs:
  createImageInterlacePR:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: run shell script to make image interlace
        run: cd scripts && ./image-interlace.sh
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          commit-message: "feat: make image interlace"
          title: "[AutoCreate]ä½¿å›¾ç‰‡äº¤é”™ make image interlace"
          body: "å›¾ç‰‡äº¤é”™ç¼–ç ï¼Œèƒ½å¤Ÿæ›´å¿«çš„ä¸‹è½½å±•ç¤º"
          branch: autocreate/image-interlace
```

åˆ°è¿™é‡Œï¼Œå°±å®ç°äº† master åˆ†æ”¯ä¿®æ”¹åï¼Œè‡ªåŠ¨æäº¤å›¾ç‰‡äº¤é”™ä¼˜åŒ– PRï¼Œç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨åˆå¹¶è¯¥ä¼˜åŒ–ã€‚é‚£è¿˜ä¸èƒ½åšçš„æ›´å¥½å‘¢ï¼Ÿå¦‚æœä½ å……åˆ†ä¿¡ä»»æä¼˜åŒ–å¹¶æ PR çš„é€»è¾‘ï¼Œå¯ä»¥å‚ç…§å¼•ç”¨ä¸­è‡ªåŠ¨æ PR éƒ¨åˆ†ï¼Œæœ‰ä¸€ä¸ªè‡ªåŠ¨æå¹¶è‡ªåŠ¨åˆå…¥çš„ actionï¼

#### ã€å†è¿›é˜¶ã€‘æµ“ç¼©å°±æ˜¯ç²¾å â˜…â˜…â˜…

> 2023 11 æœˆ 17 æ—¥

çœ‹è§æ–‡ç« åçš„æœ‹å‹ä»¬ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨è¿™ä¸ªè„šæœ¬ã€è¿™ä¸ª action yml æ–‡ä»¶æ¥å®ç°è‡ªåŠ¨äº¤é”™å›¾ç‰‡ã€‚ä½†æ²¡çœ‹è§çš„ï¼ŒåŒæ ·æœ‰ç±»ä¼¼éœ€æ±‚çš„æœ‹å‹ï¼Œåªèƒ½åœ¨ç½‘ä¸Šæœé›†èµ„æ–™ï¼Œæ¥å®ç°ä¸€ä¸ªç±»ä¼¼çš„ã€‚

å› æ­¤è¿™é‡Œæˆ‘å°†ä¸Šé¢è‡ªå»º action æµç¨‹å°è£…æˆäº†ä¸€ä¸ªæ–°çš„ action [ï¼ˆImg interlace actionï¼‰](https://github.com/hanhan9449/img-interlace-action)ã€‚å¼•å…¥åªéœ€è¦åœ¨ github action è„šæœ¬ä¸­æ·»åŠ è¯¥ action å³å¯ã€‚ä½¿ç”¨åˆç®€åŒ–äº†ä¸€æˆª~~~~

ä¸Šé“¾æ¥ï¼

https://github.com/hanhan9449/hanhan9449.github.io/blob/master/.github/workflows/make-image-interlace.yml

```yml
name: Make image interlace
on:
  push:
    branches:
      - master

jobs:
  createImageInterlacePR:
    runs-on: ubuntu-latest
    steps:
      - uses: hanhan9449/img-interlace-action@v1
        with:
          folder-root: "./docs/public"
```

## å¼•ç”¨

- https://en.wikipedia.org/wiki/Adam7_algorithm

    - ç»´åŸºç™¾ç§‘å¯¹å›¾ç‰‡äº¤é”™ç®—æ³•çš„è§£é‡Š

- https://zh.wikipedia.org/wiki/ImageMagick

    - ç»´åŸºç™¾ç§‘å¯¹ imageMagick çš„è§£é‡Š

- https://docs.github.com/zh/actions/learn-github-actions/understanding-github-actions

    - ä»€ä¹ˆæ˜¯ github actionï¼Œå®˜æ–¹å¯¹æ­¤åšäº†ä»‹ç»

- https://github.com/marketplace/actions/create-pull-request
    - github ä¸­è‡ªåŠ¨æ PR çš„ action